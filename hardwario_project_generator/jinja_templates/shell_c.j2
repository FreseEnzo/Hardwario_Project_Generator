/*
 * Copyright (c) 2023 HARDWARIO a.s.
 *
 * SPDX-License-Identifier: LicenseRef-HARDWARIO-5-Clause
 */
{%- for shell_include in shell_includes %}
#include {{ shell_include }}
{%- endfor %}

/* Zephyr includes */
{%- for zephyr_include in zephyr_includes %}
#include {{ zephyr_include }}
{%- endfor %}

/* Standard includes */
{%- for std_include in standard_shell_includes %}
#include {{ std_include }}
{%- endfor %}

LOG_MODULE_REGISTER(app_shell, LOG_LEVEL_INF);

static int print_help(const struct shell *shell, size_t argc, char **argv) {
    if (argc > 1) {
        shell_error(shell, "command not found: %s", argv[1]);
        shell_help(shell);
        return -EINVAL;
    }

    shell_help(shell);
    return 0;
}

/* clang-format off */

SHELL_STATIC_SUBCMD_SET_CREATE(
    sub_app_config,

    {%- for command in commands %}
    {%- if command.name == 'show' %}
    SHELL_CMD_ARG(show, NULL, "List current configuration.", app_config_cmd_config_show, 1, 0),
    {%- endif %}
    {%- endfor %}
    
    {%- for parameter in parameters %}
    SHELL_CMD_ARG({{ parameter.name }}, NULL, "{{ parameter.help }}", app_config_cmd_{{ parameter.var }}, 1, 1),
    {%- endfor %}
        
SHELL_SUBCMD_SET_END
);

SHELL_STATIC_SUBCMD_SET_CREATE(
    sub_app,

    SHELL_CMD_ARG(config, &sub_app_config, "Configuration commands.", print_help, 1, 0),
        
    SHELL_SUBCMD_SET_END
);

SHELL_CMD_REGISTER(app, &sub_app, "Application commands.", print_help);
{%- for command in commands %}
SHELL_CMD_ARG({{ command.name }}, NULL, "{{ command.help }}", app_config_cmd_{{ command.callback }}, 1, 1),
{%- endfor %}
/* clang-format on */